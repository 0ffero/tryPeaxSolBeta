"use strict";var vars={version:.99,revision:"rev 029",revisionInfo:["Beta State: Unlocks are now fully set up. Still to implement switching card sets. Tints work though :)","Version: 0.99 - Everything thats meant to be in the game is now in the game.","   Just need to finish all systems so they interact properly.","   + polish","Release of demo build should be available very soon.","Revision 001   - AI was introduced.","Revision 004   - AI FINISHED.","Revision 005   - Switching tints now works","Revision 006   - Limited the particles on the main screen (was 4000 per second and looked awesome but was very slow). Now theres approx 310. Particles are also killed when switching screens.","                   - OK, I wasnt expecting that kind of difference in performance. Only problem is the fireworks shader. When this game is played on the gateway.. umm.. lol?","                   - The shader is used on the high score table as well as on the unlockables loot box emulator and the win screen","                   - (its created on demand for the win screen)","Revision 007   - Player no longer gets 100 points for simply turning a remaining card.","Revision 008   - I changed a few things with regards to unlocks (specifically card sets), however was forced to reset all data (0.07). Linking to card sets images have been delayed. But it should work now. Due to this reset Im simply testing the game.","                   - I could just give myself 3000 UPs and quickly test DELAYED, but Id rather put the testing time in to find any problems before this goes live.","Revision 009   - When entering your name the fireworks shader is pushed into the input container. When clicking OK it moves it back to the high score table","Revision 010   - High score input update. Added a couple of shadows. Centred input panel (wasnt noticable before fireworks was added to bg).","Revision 011   - High score table, when sorted by score is using a new function that takes into consideration the times.","Revision 012   - Same with times rev 011 (untested until I have two times that are equal - again, im going to play the game rather than change a saved time. More play test time)","Revision 013   - More High score table updates. inc moving the replay button to its own icon","Revision 014   - Fixed a bug with the time coins (user was getting the full 90, instead of 90-their time)","Revision 015a  - Tightened up the UI transitions between mainScreen and highScoreTable.","                   - If a transition is interrupted a new container var holds that fact.","                   - When closing the interrupter the mainScreen is shown again if applicable. Still needs some work coz apparently its 4:42am :S","                   - This is a good reason to create a UI and Containers class next time so we can track tweens.","Revision 16    - Most recent high score is now highlighted (in green). After entering player name the page with the new score is automatically shown first.","               - Changing \"sort by\" will also regenerate the pages and show players auto display the appropriate page","Revision 17a   - UI Updates. Added shadows to well done screens text. Mostly implemented Replay buttons: Currently you have to change pages before the buttons show.","         17b   - Replay buttons are now shown on entering the high score table.","               - When clicking on the sort by while main screen is looping, it will pause looping until the highscores page is closed.","Revision 018, 019 and 020 - Updated the UI so I can hide or show specific things on the game play UI. Used when showing tints, when AI replays a deal, when counting UPs and on standard game deal.","Revision 021   - When selecting an unlocked tint the tint tick now move to the right page and alpha is set to 1. ie Its working perfectly now. The tint just needs to be saved now.","Revision 022   - Update to how UP coins are counted. Now shows the score bonus without the time bonus, then changes the counter to the time bonus total. Thanks Alex.","Revision 023   - Unlockeds card sets are now displaying properly (had to change the default font name from default to defaultFont as this is the default card set name.","Revision 024, 025 and 026 - Unlocked card sets can now be selected. Card Tick moves appropriately. Selected card set is saved. When loading a new card set it will hide the UI and do the card spread. Added loading text.","Revision 027   - Added 10 new card sets which have the default look front face. Added lV function to update card sets if new sets arent in the lS var.","Revision 028   - As my saved games were getting quite big (56ish KB) Ive added LZ compression. Compression ability is tested and saved as a lS var. A new helper function has been added to return the solutions as an uncompressed string.","Revision 029   - Added 12 more card sets.","FUTURE REVISIONS:","Unlockable tints work. Unlockable cards, not so much.","Slow down the scroller so that it takes longer to slow down to 0"],DEBUG:0,debug:{stackedDeck:!1,overlayObject:null,overlayBG:null,overlayInit:()=>{let e=consts.canvas,a=vars.debug;a.overlayObject=scene.add.text(e.width-10,e.height-120,[],{fontSize:"18px",fontWeight:"bold",lineSpacing:7}).setOrigin(1).setData({wh:[0,0]}).setDepth(999).setVisible(!1),scene.cursors=scene.input.keyboard.createCursorKeys(),scene.input.keyboard.on("keydown-DELETE",e=>{e.stopPropagation(),vars.debug.switchOverlayVisibility()})},move:()=>{let e=vars.debug,a=[0,0];scene.cursors.left.isDown?a[0]=-10:scene.cursors.right.isDown&&(a[0]=10);scene.cursors.up.isDown?a[1]=-10:scene.cursors.down.isDown&&(a[1]=10);e.overlayBG.x+=a[0],e.overlayBG.y+=a[1],e.overlayObject.x+=a[0],e.overlayObject.y+=a[1]},switchOverlayVisibility:()=>{let e=vars.debug,a=!0;e.overlayBG.visible&&(a=!1);e.overlayBG.visible=a,e.overlayObject.visible=a},update:()=>{let e=vars.debug;e.overlayObject?null:e.overlayInit(),e.updateOverlay(),e.move()},updateOverlay:()=>{let e=[[`VERSION: ${vars.version} ${vars.revision}`],""],a=vars.game.playerStats,n=["PLAYER STATS:"];for(let e in a)n.push([e,a[e]]);let t=vars.containers,i=["CONTAINERS:"];["current","ignoreLoop","looping","pauseTime","pauseTimeOutMax","pausedByUser","waitingTimeOut"].forEach(e=>{i.push([e,t[e]])}),i.push("");let o=vars.particles,s=["PARTICLES"];["cardSuitsEnabled","currentlyRunning","mainScreenSuitInt","mainScreenSuitTimeout"].forEach(e=>{s.push([e,o[e]])}),s.push("");let d=[...e,...s,...i,...n],l=vars.debug.overlayObject;if(l.setText(d),"[0,0]"===JSON.stringify(l.getData("wh"))){l.setData({wh:[l.width,l.height]});let e=l.getCenter();vars.debug.overlayBG=scene.add.image(e.x,e.y,"whitePixel").setTint(0).setAlpha(.5).setScale(l.width+20,l.height+20).setDepth(998).setVisible(!1)}},moveAllCardsToSP:()=>{if(!vars.DEBUG)return!1;if(52===scene.groups.winDance.getLength())return!0;let e=57,a=scene.groups.winDance,n=scene.groups.cardCurrent,t=[n.list[0].x,n.list[0].y],i=[];i.push(n.list[0]),n.removeAt(0);let o=scene.groups.cardsDealt;o.list.forEach(a=>{a.setPosition(t[0],t[1]).setDepth(e),e--,i.push(a)}),o.removeAll();let s=scene.groups.cardsLeft;s.list.forEach(a=>{a.setPosition(t[0],t[1]).setDepth(e),e--,i.push(a)}),s.removeAll(),a.addMultiple(i)},testWinDance(e=!1){vars.debug.moveAllCardsToSP(),new winDance(e)}},BUGS:[],TODO:[["UNLOCKABLES"],["  ALLOW CARDS TO BE SELECTED FROM UNLCOCKEDs"],["  WHEN SELECTING A CARD THE GAME SHOULD SHOW THE SPREAD (IMPLEMENTED)"],["HIGH SCORE TABLE"],["  THE MOST RECENT ENTRY ON WIN SHOULD BE HIGHLIGHTED"],["  FIND A BETTER WAY TO INTIATE THE AI (CURRENTLY AVAILABLE BY CLICKING ON A SCORE)"]],init:function(e){switch(e){case"PRELOAD":vars.localStorage.init(),vars.files.loadAssets();break;case"CREATE":vars.audio.init(),vars.containers.init(),vars.groups.init(),vars.game.unlockables=new Unlockables(scene),vars.input.init(),vars.music.init(),vars.paths.init(),vars.shaders.init(),vars.UI.init(),vars.game.scoreCard=new ScoreCard(scene),vars.scrollers.init();break;case"GAMESCREENS":vars.UI.initMainScreen(),vars.UI.initGameScreen(),vars.UI.initOptionsScreen();break;case"STARTAPP":vars.game.init();break;default:return console.error(`Phase (${e}) was invalid!`),!1;}},checkType:(e,a)=>{let n=!1;switch(a){case"array":n=!!Array.isArray(e);break;case"boolean":case"bool":n=!("boolean"!=typeof e);break;case"float":n=!(Number.isInteger(e)||"number"!=typeof e);break;case"integer":case"int":n=!!Number.isInteger(e);break;case"number":n=!("number"!=typeof e);break;case"object":n=!("object"!=typeof e);break;case"string":case"str":n=!("string"!=typeof e);break;default:console.error(`This type (${a}) has no check!\nUnable to test variables validity.`),n=!1;}return n},files:{audio:{load:function(){vars.DEBUG?console.log("  >> Startup > \uD83D\uDDAA Loading Audio"):null;let e=vars.audio,a="sounds";e.available.newCard=[],scene.load.audio("deleteLetter",`${a}/deleteLetter.ogg`),scene.load.audio("acceptName",`${a}/acceptName.ogg`),Phaser.Utils.Array.NumberArray(0,9,"newCard").forEach(n=>{scene.load.audio(n,`${a}/${n}.ogg`),e.available.newCard.push(n)}),e.available.collectCard=[],Phaser.Utils.Array.NumberArray(1,10,"collectCard").forEach(n=>{scene.load.audio(n,`${a}/${n}.ogg`),e.available.collectCard.push(n)}),e.available.turnCard=[],Phaser.Utils.Array.NumberArray(1,5,"cardTurn").forEach(n=>{scene.load.audio(n,`${a}/${n}.ogg`),e.available.turnCard.push(n)}),scene.load.audio("cardLeftTurn",`${a}/cardTurn.ogg`),scene.load.audio("coin",`${a}/coin.ogg`),scene.load.audio("buttonClick",`${a}/buttonClick.ogg`),scene.load.audio("shuffle1",`${a}/shuffle1.ogg`),scene.load.audio("shuffle2",`${a}/shuffle2.ogg`),e.available.shuffle=["shuffle1","shuffle2"],scene.load.audio("applause",`${a}/applause.ogg`),a="music",Phaser.Utils.Array.NumberArray(1,6,"track").forEach(e=>{scene.load.audio(e,`${a}/${e}.ogg`)}),scene.load.audio("logoSound",`${a}/logoSound.ogg`)}},fonts:{load:()=>{vars.DEBUG?console.log("  >> Startup > \uD83D\uDDAA Loading Fonts"):null,scene.load.bitmapFont("defaultFont","font/rdFont.png","font/rdFont.xml"),scene.load.bitmapFont("defaultFontSmall","font/rdFontSmall.png","font/rdFontSmall.xml")}},images:{load:function(){vars.DEBUG?console.log("  >> Startup > \uD83D\uDDAA Loading Images"):null;let e="images";scene.load.image("gameBG",`${e}/game_background.jpg`),scene.load.image("whitePixel",`${e}/whitePixel.png`),scene.load.image("mainScreenMask",`${e}/mainScreen/welcomeText.png`);let a=vars.game.cardSet;scene.load.atlas("cards",`${e}/cards/${a}/cardset.png`,`${e}/cards/${a}/cardset.json`),scene.load.atlas("coins",`${e}/coins/coins.png`,`${e}/coins/coins.json`);scene.load.atlas("highScoreTable",`${e}/${"highScoreTable"}/${"highScoreTable"}.png`,`${e}/${"highScoreTable"}/${"highScoreTable"}.json`),scene.load.atlas("mainScreen",`${e}/mainScreen/mainScreen.png`,`${e}/mainScreen/mainScreen.json`),scene.load.atlas("ui",`${e}/ui/ui.png`,`${e}/ui/ui.json`);scene.load.atlas("logoScreen",`${e}/${"logoScreen"}/logoScreen.png`,`${e}/${"logoScreen"}/logoScreen.json`),scene.load.image("optionsBG",`${e}/optionsBG.png`),e="particles",scene.load.atlas("flares",`${e}/sparks.png`,`${e}/sparks.json`)}},shaders:{load:()=>{scene.load.glsl("fireworks",`shaders/fireworks/fireworks.frag`)}},loadAssets:()=>{scene.load.setPath("assets");let e=vars.files;e.audio.load(),e.fonts.load(),e.images.load(),e.shaders.load()},loadCardSet:e=>{scene.textures.list.cards.destroy(),scene.load.setPath("assets"),scene.load.atlas("cards",`images/cards/${e}/cardset.png`,`images/cards/${e}/cardset.json`),scene.load.start(),scene.load.once("complete",()=>{vars.files.cardSetLoaded()});let a=consts;scene.add.bitmapText(a.canvas.cX,a.canvas.cY,"defaultFont",`Please Wait...\n\nLoading ${e.replace("_","")} card set.`,48,1).setTint(a.tints.orange).setDropShadow(8,8).setOrigin(.5).setDepth(a.depths.unlockedCardSpread).setName("loadingCardSet")},cardSetLoaded:()=>{let e=scene.children.getByName("loadingCardSet");scene.tweens.add({targets:e,alpha:0,duration:500,onComplete:(e,a)=>{a[0].destroy()}}),vars.UI.showCardSpread()}},containers:{current:null,ignoreLoop:!0,looping:!1,paused:!1,pauseTime:0,pauseTimeOutMax:300,pausedByUser:!1,waitingToPlayLoop:["highScoreTable","mainScreen"],waitingToPlayLoopDefaults:["highScoreTable","mainScreen"],waitingTimeOut:900,waitingTimeOutMax:900,init:()=>{vars.DEBUG?console.log(`%cFN: containers > init`,`${consts.console.defaults} ${consts.console.colours.functionCall}`):null;let e=consts.depths,a=consts.layout.gameArea;scene.groups={},scene.groups.cardsDealt=scene.add.container().setName("cardsDealt"),scene.groups.cardsDealt.setDepth(1).setSize(a.width,a.height).setPosition(a.padding.x,a.padding.y),scene.groups.cardsLeft=scene.add.container().setName("cardsLeft"),scene.groups.cardsLeft.setDepth(1),scene.groups.cardCurrent=scene.add.container().setName("cardCurrent"),scene.groups.cardCurrent.setDepth(1),scene.groups.gamePlayingUI=scene.add.container().setName("gamePlayingUI"),scene.groups.gamePlayingUI.setDepth(0),scene.groups.winDance=scene.add.group().setName("winDance"),scene.containers={},scene.containers.mainScreen=scene.add.container().setName("mainScreen"),scene.containers.mainScreen.setDepth(e.mainScreen).setVisible(!0).setAlpha(1),scene.containers.optionsScreen=scene.add.container().setName("optionsScreen"),scene.containers.optionsScreen.setDepth(e.options).setVisible(!1).setAlpha(0),scene.containers.NGoptions=scene.add.container().setName("newGameOptions"),scene.containers.NGoptions.setDepth(10).setVisible(!1).setAlpha(0),scene.containers.playerLose=scene.add.container().setName("playerLose"),scene.containers.playerLose.setDepth(10).setVisible(!1).setAlpha(0),scene.containers.wellDone=scene.add.container().setName("wellDone"),scene.containers.wellDone.setDepth(15).setVisible(!1).setAlpha(0),scene.containers.splashScreen=scene.add.container().setName("splashScreen"),scene.containers.splashScreen.setDepth(e.splashScreen).setVisible(!0).setAlpha(0),scene.containers.fiveHundred=scene.add.container().setName("fiveHundred"),scene.containers.fiveHundred.setDepth(e.fiveHundred).setVisible(!1).setAlpha(0).setPosition(0,70),scene.containers.unlockedCardSpread=scene.add.container().setName("unlockedCardSpread").setDepth(e.unlockedCardSpread).setAlpha(0).setVisible(!1)},cardsDestroyAll(){let e=scene.groups,a=e.cardsDealt.getAll();a.forEach(e=>{e.destroy()}),a=e.cardsLeft.getAll(),a.forEach(e=>{e.destroy()}),a=e.cardCurrent.getAll(),a.forEach(e=>{e.destroy()}),e.cardCurrent.setDepth(1)},empty:e=>!!(scene.containers[e]||scene.groups[e])&&void(scene.containers[e]?scene.containers[e].getAll().forEach(e=>{e.destroy()}):scene.groups[e].getAll().forEach(e=>{e.destroy()})),getByName:e=>scene.groups[e]?scene.groups[e]:!!scene.containers[e]&&scene.containers[e],resetLoopVarsOnContainerQuickSwitch:()=>{let e=vars.containers;e.current="mainScreen",e.pauseTime=e.pauseTimeOutMax,e.paused=!0,e.waitingToPlayLoop=e.waitingToPlayLoopDefaults,e.waitingTimeOut=e.waitingTimeOutMax},show:(e,a=!0)=>{if(scene.containers[e]){let n=a?1:0;scene.containers[e].setVisible(a).setAlpha(n),"mainScreen"!==e||a?"mainScreen"===e&&a&&vars.particles.available.letterSparkle.resume():(vars.particles.available.letterSparkle.pause(),vars.particles.available.letterSparkle.emitters.list[0].killAll());"mainScreen"!==e||n?null:vars.particles.suitShapeDisableAll(),"mainScreen"===e&&n?vars.particles.cardSuitsEnabled=!0:null,vars.containers.current=e}},showNG:(e=!0)=>{let a=e?1:0,n=scene.containers.NGoptions;return e?n.setVisible(!0):null,scene.tweens.add({targets:n,alpha:a,duration:250,onComplete:(e,a)=>{a[0].alpha?null:a[0].setVisible(!1)}}),!0},startIntroLoop:(e=!0)=>{!0===e?null:e=!1;let a=vars.containers;a.ignoreLoop=!e,a.waitingTimeOut=a.waitingTimeOutMax},showNGOnFail:(e=!0)=>{let a=e?1:0,n=scene.containers.playerLose;return a?n.setVisible(!0):null,scene.tweens.add({targets:n,alpha:a,duration:250,onComplete:(e,a)=>{a[0].alpha?null:a[0].setVisible(!1)}}),!0}},graphics:{available:{fiveHundred:null},init:()=>{vars.DEBUG?console.log(`%cFN: graphics > init`,`${consts.console.defaults} ${consts.console.colours.functionCall}`):null;let e=vars.graphics,a=e.available.fiveHundred=scene.add.graphics();a.lineStyle(15,0,1);let n=vars.paths.available.fiveHundred;n.draw(a);let t=vars.containers.getByName("fiveHundred");t.add(a)}},groups:{init:function(){vars.DEBUG?console.log(`%cFN: groups > init`,`${consts.console.defaults} ${consts.console.colours.functionCall}`):null,scene.groups?null:scene.groups={},scene.groups.gamePlayingUIButtons=scene.add.group().setName("gamePlayingUIButtons")}},loader:null,localStorage:{canCompress:!1,cardSets:["cSdefault","cSblue","cSblue_satin","cSbrown","cSbrown_satin","cSgold","cSgreen_dark","cSgreen_muted","cSgreen_satin","cSgreen_muted_satin","cSgreen_shiny_satin","cSorange","cSorange_satin","cSpink","cSpink_satin","cSpurple","cSpurple_muted","cSpurple_muted_satin","cSpurple_satin","cSred","cSred_satin","cSyellow","cSyellow_vibrant","cSyellow_vibrant_satin","cSblue_OS","cSbrown_OS","cSgreen_bright_OS","cSgreen_dark_OS","cSorange_OS","cSpink_OS","cSpurple_muted_OS","cSpurple_OS","cSred_OS","cSyellow_OS","cSyellow_vibrant_OS","cSblue_SOS","cSbrown_SOS","cScopper_SOS","cSgold_SOS","cSgreen_bright_SOS","cSorange_SOS","cSpink_SOS","cSplatinum_SOS","cSpurple_SOS","cSred_SOS","cSsilver_SOS","cSyellow_SOS","cSyellow_vibrant_SOS"],exampleWins:"[{\"id\":\"7tp01ji1des\",\"deck\":\"2D,10H,5H,3S,6H,QS,8H,JC,5D,JS,3C,2S,3H,5S,3D,8D,JH,9D,5C,10C,8C,4S,2H,4C,4H,AH,QH,JD,7D,10S,4D,9H,QD,6C,7C,2C,KH,7H,9C,QC,AS,AD,KD,7S,KS,6S,10D,9S,KC,6D,AC,8S\",\"solution\":\"21,0,52,16q,28,49i,27,4pl,51,6hv,19,983,22,abl,50,bca,20,cpp,18,ecr,49,fas,10,gl6,48,hfs,47,k6f,46,lcq,26,n6r,23,ntp,13,pd4,12,pub,11,qfq,24,r75,4,s2u,25,snp,14,tcl,5,u1o,45,vnl,6,11pa,17,12es,44,13gk,16,1541,43,1607,42,180g,8,19kr,41,1adh,1,1bi5,15,1c5k,40,1d55,39,1efh,38,1fnf,7,1gql,37,1him,36,1igi,9,1joe,35,1kt8,34,1m5b,2,1n55,33,1nnn,32,1oj3,3,1ps6\"},{\"id\":\"8s0ervoggbb\",\"deck\":\"8D,2C,8H,8C,2D,KD,9C,QD,JS,5S,6C,6D,7S,4H,5H,KH,4D,QC,3D,10D,10H,KS,AS,AH,7H,6H,3H,QH,2S,AD,5D,9D,2H,KC,3S,JD,JC,10S,4S,3C,8S,9S,6S,9H,QS,7D,4C,AC,JH,10C,7C,5C\",\"solution\":\"23,1,22,sd,24,35b,52,4f2,51,5sp,26,91j,25,bhf,50,f30,21,h29,49,it7,19,l0d,14,n6b,15,ofb,12,pec,13,qc3,48,rie,28,tvc,16,ut0,47,1040,46,11rl,20,141p,7,168k,45,179c,44,1934,43,1alk,10,1cdb,11,1cqh,42,1e1r,5,1fmg,27,1get,17,1h77,41,1ib9,40,1kes,4,1m98,39,1o2n,38,1pjh,1,1r63,37,1s3o,6,1u89,18,1v2i,9,20th,8,21fk,36,231d,3,2472,35,251c,34,25rk,2,26tp\"},{\"id\":\"6mm92i142nv\",\"deck\":\"6S,10D,6H,4D,5H,AD,9C,4C,QS,AS,7S,8S,9S,KC,2D,10H,8C,KH,4H,4S,8H,JC,7C,QH,3D,9H,3H,5C,2S,KD,5D,7D,8D,KS,JD,9D,AH,JH,10C,6C,7H,3S,QD,AC,JS,3C,2H,2C,10S,5S,6D,QC\",\"solution\":\"27,0,20,pr,25,1md,19,2es,28,3jh,52,4s5,24,85g,22,93t,51,9v0,50,ccj,21,f34,23,gl0,12,isk,26,koc,16,mrt,13,nde,17,okc,11,pgr,49,r34,48,t9f,10,v19,14,10jq,6,11f0,15,12bf,47,1471,46,15vn,45,17g3,18,19ev,9,1anh,44,1bj3,43,1coo,7,1ech,2,1fk0,42,1ghp,5,1j21,8,1k13,41,1lfo,3,1ml2,40,1ngm,4,1ojt,39,1pdb,38,1q7l,37,1qss,36,1reo,35,1s5l,34,1sp4,33,1tbt,32,1tun,1,1utc\"},{\"id\":\"1o6ie3fa4o0\",\"deck\":\"5S,3S,8D,4D,2C,8C,4C,6D,AD,10S,2H,QC,2D,7D,7C,AH,8S,2S,6H,5H,3H,KC,9D,9S,QH,KD,4S,7S,5D,AS,9C,10D,4H,KS,10C,AC,6S,6C,QD,5C,KH,9H,7H,8H,JH,JD,JS,QS,3C,10H,JC,3D\",\"solution\":\"27,1,20,10n,19,1rd,28,33r,52,4e3,22,64c,25,781,26,801,16,905,18,9rc,21,ai7,11,bgg,51,cdp,17,iak,24,k29,10,l3j,23,m72,50,nat,49,q1r,48,ttg,12,108c,47,11j8,46,13f3,13,15a5,9,168e,5,170m,45,183n,14,1alq,8,1bf8,15,1c2m,6,1cp0,44,1dla,43,1fh4,42,1gml,4,1hv1,1,1iom,7,1jbc,2,1kch,41,1l68,40,1lqd,3,1n8i\"},{\"id\":\"14nrquure8g\",\"deck\":\"4H,6C,10C,7C,QH,8S,KC,JC,2S,5C,AC,AD,8H,QS,AS,KH,2C,3S,4C,7H,3C,6H,7S,6S,8C,QD,JS,5S,KS,4D,10D,5D,2H,9S,2D,3D,JH,QC,AH,10S,JD,KD,5H,9C,8D,6D,3H,9D,4S,10H,7D,9H\",\"solution\":\"26,0,27,j9,52,1qg,28,3gn,22,4i3,23,55l,25,7b9,20,8hf,24,9rj,51,as4,50,cd5,19,dtr,21,gme,17,i90,15,jul,16,kmc,12,mg4,49,nj5,11,qqt,48,rrq,13,t73,47,ubt,18,vvf,9,1104,46,125e,45,13a4,14,14jc,7,16r6,5,17fp,8,186q,3,19a2,44,1adb,43,1bms,42,1cl7,41,1dob,40,1f2o,39,1frm,38,1gof,6,1i2h,37,1ive,36,1jud,10,1l2k,2,1m29,4,1mk2,35,1njd,1,1on7\"},{\"id\":\"8nr9jvpf031\",\"deck\":\"JH,KH,QD,KC,AC,8S,JD,6D,5H,9C,KS,6H,4C,4H,10C,10D,9D,AD,10H,4D,7D,5C,7H,3D,8H,7S,JS,JC,QC,6C,4S,8C,3S,8D,10S,5D,6S,2S,5S,9S,QS,2D,AH,KD,3C,7C,AS,9H,QH,2H,2C,3H\",\"solution\":\"27,0,19,190,28,28r,52,5q0,26,76v,25,7sa,21,i2l,51,jvu,24,m48,20,mvd,22,nmu,12,oog,23,pd9,50,r6h,10,ufm,16,vcm,17,103f,15,11nn,49,12oj,14,162d,48,17ak,47,18na,7,1arb,46,1bo0,13,1d3j,45,1eob,44,1h0v,18,1i9h,11,1jl0,5,1kjq,4,1l5l,43,1mlc,8,1oic,9,1p1a,42,1qef,6,1rhr,41,1snc,2,1u9e,3,1v0f,1,1vom\"},{\"id\":\"5gjaes1pkod\",\"deck\":\"KD,QC,2S,10D,3C,8H,9H,JC,JS,5D,AH,9C,8D,6H,9S,JD,2C,AD,7S,KC,3D,AS,10H,9D,2H,4C,3H,QD,5C,8C,4D,2D,7D,QH,10C,3S,KH,6S,10S,5H,QS,4S,5S,7C,8S,4H,KS,JH,6D,6C,AC,7H\",\"solution\":\"26,0,27,m2,25,1qa,22,31f,17,3ui,21,8m4,52,a0d,24,evl,23,gpg,16,m8t,28,osn,20,qfh,18,rl8,51,t65,50,vs4,11,11eh,49,12ee,14,18c4,19,194p,13,1ahs,15,1bog,6,1d9n,12,1ds7,48,1fab,8,1hao,47,1iif,7,1juf,46,1lji,45,1nt6,2,1p62,9,1pr4,44,1qsm,10,1s6o,43,1t4a,42,1ucc,41,205f,40,216k,5,22cv,3,22v3,39,246g,38,2589,37,25ud,36,26o9,35,27f2,34,28i6,4,2a1e,33,2avt,32,2bk7,31,2c8d,1,2d5j\"},{\"id\":\"216vsbhf61j\",\"deck\":\"KC,QH,JD,AD,10H,10D,8C,5H,9H,7C,KS,6H,6D,5D,AS,9D,7D,9C,7S,4D,KD,3C,QS,4S,AH,JH,2D,8S,QD,6C,5S,8H,10C,JC,8D,6S,2C,5C,QC,9S,4H,3S,JS,3D,7H,3H,AC,2H,2S,4C,KH,10S\",\"solution\":\"21,0,23,n9,26,2a2,52,3h2,19,6nq,28,7m1,51,8mm,24,aag,22,b19,27,fbd,25,gh1,50,i9i,17,mmj,13,npg,14,og1,20,p3q,49,qq6,18,tvh,6,va8,16,102a,48,11m7,47,13nd,10,15mt,12,1699,8,16uj,46,17rn,45,18up,15,1ach,11,1b36,4,1bso,44,1d44,43,1dqc,42,1ek4,5,1fur,9,1grm,7,1hjk,41,1ina,40,1l2s,39,1lqc,2,1n9a,1,1q8s,38,1r2k,37,1rop,36,1siq,35,1t5o,34,1u5t,33,1uuv,32,1vh5,31,203s,30,211m,3,226n\"}]",options:null,playerName:null,pre:"TPX",scores:[],solutionIDs:null,unlockables:null,init:()=>{let e=vars.localStorage,a=window.localStorage,n=e.pre;a[`${e.pre}_canCompress`]||(a[`${e.pre}_canCompress`]="\u1862\u0C3D\u583E\u60D6\x90\u13A1\u2626\u3B48  "===LZString.compressToUTF16("CanCompress")?"true":"false"),e.canCompress="true"===a[`${e.pre}_canCompress`],a[`${n}_scores`]||(a[`${n}_scores`]="[{\"name\":\"OFFER0\",\"score\":10000,\"time\":55},{\"name\":\"OFFER0\",\"score\":7500,\"time\":65},{\"name\":\"OFFER0\",\"score\":5000,\"time\":75}]"),e.scores=JSON.parse(a[`${n}_scores`]),a[`${n}_name`]||(a[`${n}_name`]="Enter Name..."),e.playerName=a.TPX_name,a[`${n}_pStats`]||(a[`${n}_pStats`]=JSON.stringify({averageCompletionTime:0,bestStreak:0,cardsMoved:0,gamesLost:0,gamesWon:0,gamesPlayed:0,totalTimePlaying:0})),vars.game.playerStats=JSON.parse(a[`${n}_pStats`]);let t=vars.audio,i=vars.game,o=vars.gameScreen,s=vars.music;if(!a[`${n}_options`]){let d=Phaser.Utils.Array.NumberArray(1,6,"track"),l={};d.forEach(e=>{l[`${e}`]=!0});let r={music:l,userID:generateUserID(),volume:3,cardSet:"default",tint:7584255};a[`${n}_options`]=JSON.stringify(r),e.options=r,s.enabled=!0,s.loop=!1,s.available=d,t.volume=r.volume,i.cardSet=r.cardSet,o.tint=r.tint}else{let d=e.options=JSON.parse(a[`${n}_options`]),l=d.music;for(let e in l)l[e]?s.available.push(e):null;t.volume=d.volume,s.loop=1===s.available.length,s.enabled=!!s.available.length,i.cardSet=d.cardSet,o.tint=d.tint}a[`${n}_solutions`]||(a[`${n}_solutions`]=JSON.stringify({wins:[],losses:[]}));let d=e.savedSolutionsLoader(),l=[];for(let e in d)d[e][0]?l.push(d[e][0].id):null;if(e.solutionIDs=l,a[`${n}_UP`]?null:a[`${n}_UP`]=0,i.unlockPoints=~~a[`${n}_UP`],!a[`${n}_unlockables`]){let t=e.cardSets,i=Phaser.Display.Color.ColorSpectrum(65);i.pop();let o=[];i.forEach(e=>{o.push(`tint${e.color.toString(16).toUpperCase().padStart(6,"0")}`)});let s=[];for(let e,a=0;360>a;a+=6)e=Phaser.Display.Color.HSLToColor(a/360,.35,.5),s.push(`tint${e.color.toString(16).toUpperCase().padStart(6,"0")}`);let d=[...t,...o,...s],l={};d.forEach(e=>{let a=generateRandomID();"cSdefault"!==e&&(l[e]={unlocked:!1,id:a})}),l[`tint73B9FF`]={unlocked:!0,id:"1010101"},l[`cSdefault`]={unlocked:!0,id:"0101010"},a[`${n}_unlockables`]=JSON.stringify(l)}if(e.unlockables=JSON.parse(a[`${n}_unlockables`]),Object.keys(e.unlockables).includes("cSblue_OS")||(vars.DEBUG?console.groupCollapsed(`%cAdding new Original Set card sets to the unlockables list as they dont currently exist.`,"color: #10FF10; font-size: 14px"):null,e.addNewCardSets("_OS"),vars.DEBUG?console.groupEnd():null),Object.keys(e.unlockables).includes("cSblue_SOS")||(vars.DEBUG?console.groupCollapsed(`%cAdding new Satin Original Set card sets to the unlockables list as they dont currently exist.`,"color: #20FF20; font-size: 14px"):null,e.addNewCardSets("_SOS"),vars.DEBUG?console.groupEnd():null),(delete e.cardSets,a[`${n}_ULInt`]||(a[`${n}_ULInt`]="[\"1010101\",\"0101010\"]"),e.options.ULInts=JSON.parse(a[`${n}_ULInt`]),!a[`${n}_uData`]&&window.navigator)){let n=window.navigator,t={platform:n.platform,appVersion:n.appVersion,downSpeedInMbps:n.connection.downlink,totalThreads:n.hardwareConcurrency,language:n.language,languagesAvailable:n.languages.join(","),online:n.onLine,uA:n.userAgent,browserVendor:n.vendor};a[`${e.pre}_uData`]=JSON.stringify(t)}},addNewCardSets:(e=null)=>{if(!e)return!1;let a=vars.localStorage,n=window.localStorage;a.cardSets.forEach(n=>{n.endsWith(e)&&(a.unlockables[n]={unlocked:!1,id:generateRandomID()},vars.DEBUG?console.log(`Added ${n} to the unlockables list.`):null)}),n[`${a.pre}_unlockables`]=JSON.stringify(a.unlockables)},loadSolution:(e=null)=>{if(vars.DEBUG?console.log(`\n%cFN: localStorage > loadSolution ${e}`,`${consts.console.defaults} ${consts.console.colours.important}`):null,!e||!e.includes("hSSolutionID_"))return!1;let a=e.replace("hSSolutionID_",""),n=window.localStorage,t=vars.localStorage,i={deck:null,solution:null};if(JSON.parse(t.savedSolutionsLoader()).wins.every(e=>e.id!==a||(vars.DEBUG?console.log(`Solution found for ID ${a}!`):null,i.deck=e.deck,i.solution=e.solution,!0)),vars.DEBUG?console.log(i):null,i.solution&&i.deck){let e={name:null,score:null,time:null};return vars.localStorage.scores.every(n=>n.solutionID!==a||(e={name:n.name,score:n.score,time:n.time},!0)),i.scoreData=e,vars.AI.new(i),!0}return!1},resetAll:()=>{for(let e in window.localStorage)e.startsWith("TPX_")&&(vars.DEBUG?console.log(`Deleting ${e}`):null,delete window.localStorage[e])},saveCardSet:e=>{if(!vars.checkType(e,"string"))return!1;let a=window.localStorage,n=vars.localStorage;n.options.cardSet=e,a[`${n.pre}_options`]=JSON.stringify(n.options)},saveUnlocks:e=>{if(!vars.checkType(e,"object"))return!1;let a=vars.localStorage,n=window.localStorage;n[`${a.pre}_unlockables`]=JSON.stringify(e)},saveUnlockIDs:e=>{if(!vars.checkType(e,"array"))return!1;let a=vars.localStorage,n=window.localStorage;n[`${a.pre}_ULInt`]=JSON.stringify(e)},savePlayerName:e=>{let a=vars.localStorage,n=window.localStorage;return a.playerName=e,n.TPX_name=e,!0},savePlayerStats:()=>{let e=vars.localStorage,a=window.localStorage,n=vars.game.playerStats;return a[`${e.pre}_pStats`]=JSON.stringify(n),!0},saveScores:e=>{let a=vars.localStorage,n=window.localStorage;return a.scores=e,n.TPX_scores=JSON.stringify(e),!0},saveSolution:e=>{let a,n=vars.localStorage,t=window.localStorage,i=n.solutionIDs.length;do{a=generateRandomID(!0);let e=BigInt(a);a=e.toString(32),n.solutionIDs.includes(a)?vars.DEBUG?console.warn(`Solution ID ${a} already exists!\nYou will probably never see this msg as the IDs are 16 random numbers.`):null:n.solutionIDs.push(a)}while(n.solutionIDs.length==i);let o=JSON.parse(n.savedSolutionsLoader()),s=e[0]?"wins":"losses",d="wins"===s?e[1]:null;o[s].push({id:a,deck:d,solution:e[2]});let l=n.canCompress?LZString.compressToUTF16(JSON.stringify(o)):JSON.stringify(o);return t[`${n.pre}_solutions`]=l,a},savedSolutionsLoader:()=>{let e=vars.localStorage,a=window.localStorage,n=null;if(e.canCompress){let t=a[`${e.pre}_solutions`];n=LZString.decompressFromUTF16(t)}else n=a[`${e.pre}_solutions`];return n},saveTint:e=>{let a=vars.localStorage,n=window.localStorage,t=a.options;t.tint=e,n[`${a.pre}_options`]=JSON.stringify(t)},saveVolume:()=>{let e=window.localStorage,a=vars.localStorage,n=a.options;n.volume=vars.audio.volume,e[`${a.pre}_options`]=JSON.stringify(n)},updateTrackList:(e,a)=>{if("trackAll"===e)return!1;if(!vars.checkType(a,"bool"))return console.error(`Invalid enabled (${a})`),!1;!vars.checkType(e,"string")&&Number.isInteger(e)?e=`track${e}`:null;let n=vars.localStorage,t=n.options;t.music[e]=a;let i=window.localStorage;i[`${n.pre}_options`]=JSON.stringify(t)},updateUnlockPoints:()=>{let e=window.localStorage,a=vars.localStorage;e[`${a.pre}_UP`]=vars.game.unlockPoints}},AI:{current:null,new:e=>{let a=vars.AI;if(a.current=new AI(e.deck,e.solution,e.scoreData),!a.current.errors.length)vars.DEBUG?console.log(`New AI created. No errors found.\nStarting the AI...`):null,a.current.getUIReady();else return console.error(`Errors found!`),console.error(a.current.errors),!1;return!0},disableInteractiveOnAllCards:()=>{["cardsDealt","cardsLeft","cardCurrent"].forEach(e=>{vars.containers.getByName(e).getAll().forEach(e=>{e.disableInteractive()})})},requestNextMove:()=>{vars.AI.current.playNextMove()},destroy:()=>{vars.AI.current=null}},anims:{init:function(){vars.DEBUG?console.log(`%cFN: anims > init`,`${consts.console.defaults} ${consts.console.colours.functionCall}`):null},animate500:()=>{let e=vars.containers.getByName("fiveHundred"),a=consts.canvas,n=333;vars.particles.fiveHundredShow(!0),e.x=-a.cX-400,scene.tweens.add({targets:e,x:-100,duration:n,hold:1e3,ease:"Quad.easeIn",onComplete:(e,t)=>{scene.add.tween({targets:t[0],x:a.cX+400,duration:n,ease:"Quad.easeOut",onComplete:()=>{vars.particles.fiveHundredShow(!1)}})}})}},audio:{available:{},volume:4,init:function(){vars.DEBUG?console.log(`%cFN: audio > init`,`${consts.console.defaults} ${consts.console.colours.functionCall}`):null,scene.sound.setVolume(vars.audio.volume/10)},playRandom:e=>{let a=vars.audio;return!!a.available[e]&&(a.playSound(getRandom(a.available[e])),!0)},playShuffle:()=>{let e=getRandom(vars.audio.available.shuffle);scene.sound.play(e)},playSound:function(e){scene.sound.play(e)},volumeChange:(e=!0)=>{if(vars.DEBUG){let a=e?" ++ Increasing volume.":" -- Decreasing volume.";vars.DEBUG?console.log(`${a}`):null}let a=vars.audio;if(e&&10>a.volume)a.volume++;else if(!e&&0<a.volume)a.volume--;else return vars.audio.playSound("deleteLetter"),!1;vars.DEBUG?console.log(`    New volume is ${a.volume}`):null,vars.audio.playSound("buttonClick"),scene.sound.volume=a.volume/10,vars.localStorage.saveVolume(),vars.UI.updateVolume()}},camera:{mainCam:null,init:function(){vars.DEBUG?console.log(`%cFN: camera > init`,`${consts.console.defaults} ${consts.console.colours.functionCall}`):null,vars.camera.mainCam=scene.cameras.main},shake:function(e=1e3){return vars.DEBUG?console.log(`%cFN: camera > shake`,`${consts.console.defaults} ${consts.console.colours.functionCall}`):null,!!vars.checkType(e,"int")&&void vars.camera.mainCam.shake(e)}},game:{phaserGameObject:null,deal:null,deck:null,cardSet:null,penaliseErrors:!1,playerStats:null,scoreCard:null,unlockables:null,div:100,maxTime:90,unlockPoints:0,unlockPointData:{UPTotal:0,scorePoints:0,scoreCoins:[0,0],scoreCoinWait:0,timePoints:0,timeCoins:[0,0]},init:function(){vars.DEBUG?console.log(`\n%cFN: game > init`,`${consts.console.defaults.replace("14","16")} ${consts.console.colours.important}`):null,vars.music.getNextTrack(),vars.gameScreen.enabled=!0,vars.containers.startIntroLoop(!1),vars.containers.show("wellDone",!1),vars.UI.showGameplayUI(!1,.1,"initGame"),vars.audio.playShuffle(),vars.UI.newMessage("Shuffling Deck...",null,null,750,1500),vars.UI.showForegroundBarrier(!1),scene.tweens.addCounter({from:0,to:1,duration:1e3,onComplete:()=>{let e=vars.game;e.deck=new Deck,e.deal=new Deal(e.deck),vars.game.waitForDeal()}}),vars.UI.updateScore(0),vars.UI.initNewDealScreen(),vars.UI.initPlayerLose(),vars.containers.looping=!1},getCoins:e=>{return[~~(e/10),e%10]},getUnlockPoints:(e=0,a=0)=>{if(!vars.checkType(e,"int")||!vars.checkType(a,"number"))return console.error(`Invalid score (${e.toString()}) or time (${a.toString})`),!1;let n=vars.game,t=n.unlockPointData,i=n.unlockPoints,o=n.div,s=n.maxTime,d=a,l=e/o;t.scorePoints=l,t.scoreCoins=n.getCoins(l),vars.DEBUG?console.table({scorePoints:l}):null;let r=0;n.deal.win?(r=d<s?~~(s-d):0,t.timePoints=r,t.timeCoins=n.getCoins(r),vars.DEBUG?console.table({timePoints:t.timePoints}):null):(t.timePoints=0,t.timeCoins=[0,0]);t.UPTotal=t.scorePoints+t.timePoints;let c=vars.containers.getByName("gamePlayingUI").getByName("bonusTypeText");c.setText(`BONUS POINTS FOR SCORE\n${t.scorePoints}`);let u=i+t.UPTotal;n.unlockPoints=u,vars.localStorage.updateUnlockPoints(),n.unlockPoints>=consts.unlockPoints.randomRoll&&n.unlockables.showRandomRollButton();vars.UI.increaseUPCount()},newGameUIResets:()=>{vars.UI.updateScore(0),vars.UI.updateMultiplier(0),vars.particles.multiplierHighlightStart(!1),vars.UI.updateTimer(0)},resetUPData:()=>{vars.game.unlockPointData={UPTotal:0,scorePoints:0,scoreCoins:[0,0],scoreCoinWait:0,timePoints:0,timeCoins:[0,0]}},restart:()=>{vars.containers.looping=!1,vars.containers.cardsDestroyAll(),vars.containers.show("wellDone",!1),vars.containers.startIntroLoop(!1),vars.game.newGameUIResets(),vars.UI.showForegroundBarrier(!1),vars.audio.playShuffle(),vars.UI.newMessage("Shuffling Deck...",null,null,750,1500),scene.tweens.addCounter({from:0,to:1,duration:1250,onComplete:()=>{let e=vars.game;e.deck=new Deck,e.deal=new Deal(e.deck),vars.game.waitForDeal()}})},scrollerDestroy:()=>{vars.game.unlockables.scrollerDestroy()},scrollerHideNotWons:()=>{vars.game.unlockables.scrollerHideNotWons()},scrollerShaderAdd:()=>{vars.game.unlockables.scrollerShaderAdd()},scrollerZoomInOnWin:()=>{vars.game.unlockables.scrollerZoomInOnWin()},scrollerShowWinMessage:()=>{vars.game.unlockables.scrollerShowWinMessage()},setBGTint:e=>{vars.game.unlockables.available.tints.every(a=>{if(a[0]===e){let e=vars.containers.getByName("gamePlayingUI");return e.getByName("game_bg").setTint(a[3]),vars.localStorage.saveTint(a[3]),vars.game.showUnlockedTint(),!0}return!0})},setCardSet:e=>(vars.DEBUG?console.log(`Setting new card set ${e}`):null,vars.game.cardSet!==e&&void(vars.game.cardSet=e,vars.game.unlockables.hideAllContainers(),vars.files.loadCardSet(e))),showUnlockedTint:()=>{let e=vars.containers.getByName("optionsScreen"),a=vars.game.unlockables.containers.unlocked;vars.UI.showGameplayUI(!1,.1,"tintView"),scene.tweens.add({targets:[e,a],alpha:0,hold:1500,duration:250,yoyo:!0,onComplete:()=>{vars.UI.showGameplayUI(!0)}})},waitForDeal:()=>{vars.game.deal.allCardsDealt?vars.UI.showGameplayUI(!0):scene.tweens.addCounter({from:0,to:1,duration:500,onComplete:()=>{vars.game.waitForDeal()}})}},gameScreen:{update:()=>{}},input:{init:()=>{vars.DEBUG?console.log(`%cFN: input > init`,`${consts.console.defaults} ${consts.console.colours.functionCall}`):null,scene.input.on("gameobjectup",function(e,a){return e.button?(vars.DEBUG?console.log(a.name,a.data&&a.data.list?a.data.list:"No Data",a):null,!0):void vars.input.dealWithClick(a)}),scene.input.on("gameobjectover",function(){}),scene.input.on("gameobjectout",function(){})},dealWithClick:e=>{let a=vars.input,n=e;if(n.name.startsWith("HSL_"))return!1;if(n.name.includes("card_"))return vars.game.deal.clickOnCard(n),!0;if(n.name.startsWith("NG_"))return a.newGameOptionClicked(n),!0;if(n.name.endsWith("Button_ui"))return a.dealWithUIButtonClick(n),!0;if(n.name.startsWith("MS_")&&!n.name.endsWith("moreInfoButton")){let e=vars.containers;if("MS_newGame"===n.name)return e.ignoreLoop=!0,vars.audio.playSound("buttonClick"),e.show("mainScreen",!1),vars.init("STARTAPP"),!0;if("MS_hiScores"===n.name)return e.pausedByUser=!0,vars.containers.startIntroLoop(!1),e.show("highScoreTable",!0),vars.game.scoreCard.showHSTableButtons(!0),vars.game.scoreCard.showHSTableReplayButtons(!0),!0;if("MS_options"===n.name)return e.pausedByUser=!0,vars.containers.startIntroLoop(!1),e.looping?e.show("mainScreen",!1):null,e.show("optionsScreen",!0),vars.game.unlockables.showContainer("options"),!0}if("WD_enterName"===n.name){vars.audio.playSound("buttonClick"),vars.UI.wellDoneDestroy(),vars.containers.show("wellDone",!1);let e=vars.game.scoreCard;return e.moveShaderToNewContainer("inputName"),e.inputContainer.setVisible(!0),!0}if(n.name.endsWith("_HSTB"))return a.highScoreTableButtonClick(n),!0;if(n.name.startsWith("hSSolutionID_"))return vars.localStorage.loadSolution(n.name),!0;if("game_fg"===n.name)return vars.DEBUG?console.warn(`This is the foreground for the game area. This should not be visible during gameplay!`):null,!0;if("highScoreTableBG"===n.name&&!vars.containers.ignoreLoop){let e=vars.containers;e.show("highScoreTable",!1),e.show("mainScreen",!0),e.resetLoopVarsOnContainerQuickSwitch()}if(n.name.startsWith("options_"))return a.optionsClick(n),!0;if(n.name.endsWith("moreInfoButton")){if(n.name.startsWith("MS_")){vars.containers.ignoreLoop=!0;let e=vars.scrollers.available.Rules;e.clickFrom="mainScreen",e.fadeIn(!0)}return!0}if(n.name.startsWith("SCRL_"))return vars.scrollers.available.Rules.click(n.name),!0;return n.name.startsWith("unlock_cS_")||n.name.startsWith("unlock_cSUI_")?(vars.game.unlockables.unlockSpecific(n,"cardSet"),!0):n.name.startsWith("unlock_tint_")||n.name.startsWith("unlock_tintUI_")?(vars.game.unlockables.unlockSpecific(n,"tint"),!0):!(n.name.startsWith("UNL_")||n.name.startsWith("UNLD_")||n.name.startsWith("CSU_")||n.name.startsWith("TU_"))&&"unlockablesHeader"!==n.name&&"lootboxemuBG"!==n.name&&void(vars.DEBUG?console.log(`The game object with name "${n.name}" has no click handler.`):null)},dealWithUIButtonClick:e=>{vars.audio.playSound("buttonClick");let a=vars.containers;return e.name.startsWith("newGame")?(console.clear(),scene.containers.NGoptions.setVisible(!0),a.showNG(!0),!0):e.name.startsWith("home")?(a.ignoreLoop=!1,a.looping=!0,vars.UI.showMainScreen(),!0):void(vars.DEBUG?console.log(`The game object with name "${e.name}" has no click handler.`):null)},highScoreTableButtonClick:e=>{let a=vars.game.scoreCard;switch(e.name){case"times_HSTB":return vars.containers.ignoreLoop=!0,vars.containers.waitingTimeOut=0,a.buildHighScorePages("time"),a.switchVisible(),!0;break;case"scores_HSTB":return vars.containers.ignoreLoop=!0,vars.containers.waitingTimeOut=0,a.buildHighScorePages("score"),a.switchVisible(),!0;break;case"close_HSTB":vars.DEBUG?console.log(` >>> Closing High Score Table`):null;let n=vars.containers;n.show("highScoreTable",!1),n.pausedByUser&&(n.show("mainScreen",!0),n.pausedByUser=!1);;n.looping?n.ignoreLoop=!1:n.showNGOnFail(!0);;return a.showHSTableButtons(!1),a.showHSTableReplayButtons(!1),!0;break;case"nextPage_HSTB":case"previousPage_HSTB":let t=!!e.name.startsWith("next");a.showHighScorePage(t);break;default:return vars.DEBUG?console.log(`HIGH SCORE TABLE BUTTON\n  There's no handler for button with name ${e.name}`):null,!1;}},newGameOptionClicked:e=>{vars.audio.playSound("buttonClick");let a=e.name.replace("NG_","").replace("_Button_ui","");switch(a){case"CANCEL":return vars.containers.show("NGoptions",!1),void vars.containers.showNGOnFail(!1);break;case"NEWDEAL":return vars.containers.showNG(!1),vars.containers.showNGOnFail(!1),vars.game.restart(),!0;break;case"HIGHSCORES":return vars.game.scoreCard.showHighScoreTable(!0),vars.containers.showNGOnFail(!1),!0;break;case"HOME":return vars.containers.showNGOnFail(!1),vars.containers.startIntroLoop(!0),vars.UI.showMainScreen(),!0;break;case"EXIT":return console.log("Exiting game!\nGoodbye."),!1;}vars.DEBUG?console.log(`Button "${e.name}" has no handler!`):null},optionsClick:e=>{let a=e.name;if(a.startsWith("options_track")){a=a.replace("options_track","");let n=a.split("_"),t=n[0],i=n[1];return vars.DEBUG?console.table(`Track: ${t}. Currently: ${i}`):null,vars.input.optionsClickMusic(e,t,i),!0}if(a.includes("volume")){let e=a.replace(/options_volume/,"");return"Up"===e?vars.audio.volumeChange(!0):vars.audio.volumeChange(!1),!0}if("options_close"===a){let e=vars.containers;return e.show("optionsScreen",!1),e.pausedByUser=!1,vars.game.unlockables.hideAllContainers(),vars.music.playableRebuild(),e.looping&&(e.ignoreLoop=!1,e.show("mainScreen",!0)),!0}vars.DEBUG?console.log(`${a} has no click handler!`):null},optionsClickMusic:(e,a,n)=>{let t=vars.music;if("All"===a){if("off"===n){let e=vars.localStorage.options.music;t.cached={...e},vars.DEBUG?console.log(`Setting all tracks to off...`):null,vars.music.disableAll()}else if("on"===n){let e=vars.containers.getByName("optionsScreen");for(let a in t.cached){let n=e.getByName(`options_${a}_on`),i=e.getByName(`options_${a}_off`);t.cached[a]?(n.setAlpha(0),i.setAlpha(1)):(n.setAlpha(1),i.setAlpha(0))}t.cached=null}return!0}if("play"===n)return"stopTrackIcon"===e.frame.name?(vars.DEBUG?console.log(`Stopping track ${a}`):null,vars.music.stopTrack(),vars.UI.swapMusicPlayButton(e),vars.update.updateTrackBar(!0),!0):(vars.DEBUG?console.log(`Playing track ${a}`):null,vars.containers.getByName("optionsScreen").getAll().forEach(e=>{e.name.endsWith("_play")&&e.setFrame("playTrackIcon")}),t.stopTrack(),t.loop=!0,t.playTrack(`track${a}`),vars.UI.swapMusicPlayButton(e),!0);if("on"===n)return vars.DEBUG?console.log(`Disabling track ${a}`):null,vars.UI.swapMusicEnableButton(a),!0;return"off"===n?(vars.DEBUG?console.log(`Enabling track ${a}`):null,vars.UI.swapMusicEnableButton(a),!0):void(vars.DEBUG?console.log(`${e.name} has no click handler`):null)},switchVisibleUnlocksContainer:()=>{vars.game.unlockables.switchVisibleContainer()}},mainScreen:{width:553,height:533,cardSuitParticlesUpdate:()=>{let e=vars.particles;if(!e.cardSuitsEnabled)return!1;if(e.mainScreenSuitTimeout)return void e.mainScreenSuitTimeout--;e.mainScreenSuitTimeout=e.mainScreenSuitTimeoutMax;let a=e.mainScreenSuitInt;e.suitShapeEnable(!1,a),a+1>e.mainScreenSuits.length-1?e.mainScreenSuitInt=0:e.mainScreenSuitInt++,e.suitShapeEnable(!0,e.mainScreenSuitInt)}},music:{available:[],cached:null,enabled:!1,loop:!1,playing:null,optionScreenCurrentlyPlaying:[],init:()=>{shuffle(vars.music.available)},disableAll:()=>{[1,2,3,4,5,6,"All"].forEach(e=>{vars.UI.swapMusicEnableButton(e,!0)})},getNextTrack:()=>{let e=vars.music;if(!e.enabled)return!1;e.playing=null;let a=e.available,n=a.shift();a.push(n),vars.DEBUG?console.log(`Playing ${n}`):null,e.playTrack(n)},playTrack:e=>{let a=vars.music;if(!a.enabled||a.playing)return!1;let n={loop:a.loop};a.playing=scene.sound.add(e,n);let t=~~e.replace("track","");a.loop||a.playing.on("complete",()=>{vars.music.getNextTrack()}),a.playing.play();let i=scene.containers.optionsScreen.getByName("playingTrackBar"),o=i.getData("maxWH");i.y=o[2]+(t-1)*o[3]},playableRebuild:()=>{let e=vars.music,a=!!e.playing,n=vars.localStorage.options.music,t=!1;return a?n[e.playing.key]||(e.playing.stop(),t=!0):e.available.length&&(t=!0),t&&e.available.length?(shuffle(e.available),e.enabled=!0,e.getNextTrack()):e.enabled=!1,!0},stopTrack:()=>{if(!vars.music.playing)return!1;let e=vars.music;e.playing.stop(),e.playing=null},updateAvailableTracks:(e,a)=>{let n=vars.music;return a?(n.available.push(e),!0):(n.available.every((a,t)=>e!==a||(n.available.splice(t,1),!0)),!0)}},phaserObject:{mainScreen:{getRandomPoint:function(e){let a,n,t,i=[205,275];do a=Phaser.Math.Between(0,vars.mainScreen.width-1),n=Phaser.Math.Between(0,vars.mainScreen.height-1),t=scene.textures.getPixel(a,n,"mainScreenMask");while(255>t.alpha);return e.setTo(a+i[0],n+i[1])}}},particles:{available:{},cardSuitsEnabled:!1,currentlyRunning:"mainScreen",mainScreenSuitInt:null,mainScreenSuitTimeout:209,mainScreenSuitTimeoutMax:209,mainScreenSuits:[],outlines:{heartShape:[],clubShape:[]},init:()=>{let e=vars.particles;e.cardSuitsInit(),e.fiveHundredInit(),e.sparklesInit(),e.multiplierHighlightInit()},clubShape:{getPoints:function(){let e=vars.particles.outlines.clubShape,n=2*Math.PI,t=24;for(let i=0;i<n;i+=.03){let a=16*Math.pow(Math.sin(i),3)*t,n=(13*Math.cos(i)-5*Math.cos(2*i)-2*Math.cos(3*i)-Math.cos(4*i))*t;e.push(new Phaser.Geom.Point(a,n-50))}return e}},heartShape:{getPoints:function(){let e=vars.particles.outlines.heartShape,n=2*Math.PI,t=24;for(let i=0;i<n;i+=.03){let a=16*Math.pow(Math.sin(i),3)*t,n=-(13*Math.cos(i)-5*Math.cos(2*i)-2*Math.cos(3*i)-Math.cos(4*i))*t;e.push(new Phaser.Geom.Point(a,n-50))}return e}},cardSuitsInit:()=>{let e=vars.particles;e.available.heartShape=scene.add.particles("flares").setDepth(consts.depths.mainScreen);let a=e.available.heartShape.createEmitter({frame:"white",tint:16723968,lifespan:2e3,x:480,y:540,quantity:1,alpha:{start:.5,end:0},scale:{start:1,end:0},blendMode:1,emitZone:{type:"edge",source:vars.particles.heartShape,quantity:100}});a.name="hearts",e.mainScreenSuits.push("hearts"),a=e.available.heartShape.createEmitter({frame:"white",tint:2236962,lifespan:2e3,x:480,y:590,quantity:1,alpha:{start:.5,end:0},scale:{start:.9,end:0},emitZone:{type:"edge",source:vars.particles.clubShape,quantity:100}}),a.name="clubs",e.mainScreenSuits.push("clubs"),e.suitShapeDisableAll()},fiveHundredInit:()=>{let e=vars.particles,a=e.available.fiveHundred=scene.add.particles("flares");a.setDepth(consts.depths.fiveHundred),a.createEmitter({frame:"white",scale:{start:.8,end:0},tint:[65280,16776960,16777215],blendMode:"ADD",alpha:{start:.33,end:0},gravityY:-90,quantity:64,lifespan:333,emitZone:{source:vars.paths.available.fiveHundred}}),scene.tweens.addCounter({from:0,to:1,duration:2e3,onComplete:()=>{vars.particles.available.fiveHundred.emitters.list[0].pause()}});let n=vars.containers.getByName("fiveHundred");n.add(a),n.setAlpha(0).setVisible(0)},fiveHundredShow:(e=!0)=>{let a=vars.particles.available.fiveHundred,n=a.emitters.list[0],t=vars.containers.getByName("fiveHundred");e?(t.setVisible(!0).setAlpha(1),n.resume()):(t.setVisible(!1).setAlpha(0),n.pause())},multiplierHighlightInit:()=>{let e=consts.canvas,a=new Phaser.Geom.Circle(e.cX-180,e.height-216,52),n=vars.particles;n.available.multiplierHighlight=scene.add.particles("flares"),n.available.multiplierHighlight.createEmitter({frame:"white",tint:16777215,lifespan:1e3,scale:{start:.4,end:0},emitZone:{type:"edge",source:a,quantity:60},blendMode:"ADD",active:!1})},sparklesInit:()=>{let e=vars.particles;e.available.letterSparkle=scene.add.particles("flares"),e.available.letterSparkle.createEmitter({x:0,y:0,frame:"white",tint:16711680,quantity:10,lifespan:500,gravityY:1,scale:{start:0,end:.5},alpha:{start:.5,end:0},blendMode:0,emitZone:{type:"random",source:vars.phaserObject.mainScreen}})},multiplierHighlightChangeColour:()=>{let e=vars.game.deck.currentStreak;if(!e)return!1;let a=consts.colours.multiplierHighlights[e-1],n=vars.particles.available.multiplierHighlight;n.emitters.list[0].setTint(a)},multiplierHighlightStart:(e=!0)=>{let a=vars.particles.available.multiplierHighlight.emitters.list[0];a.setVisible(e),a.active=e},suitShapeDisableAll:()=>{let e=vars.particles;e.available.heartShape.emitters.list.forEach(e=>{e.killAll(),e.stop()}),e.cardSuitsEnabled=!1,e.mainScreenSuitTimeout=1},suitShapeEnable:(e=!0,a=null)=>{if(!vars.checkType(a,"int"))return!1;let n=vars.particles,t=n.available.heartShape.emitters.list,i=t[a];e?(i.start(),n.mainScreenSuitInt=a):(i.stop(),n.mainScreenSuitInt=null)}},paths:{available:{clubs:null,spades:null,fiveHundred:null},init:()=>{let e=consts.canvas,a=vars.paths;a.available.clubs=new Phaser.Curves.Path(e.cX-100,e.cY+100),a.available.clubs.cubicBezierTo(e.cX-100,e.cY-100,e.cX-350,e.cY+200,e.cX-350,e.cY-200),a.available.clubs.cubicBezierTo(e.cX+100,e.cY-100,e.cX-200,e.cY-350,e.cX+200,e.cY-350),a.available.clubs.cubicBezierTo(e.cX+100,e.cY+100,e.cX+350,e.cY-200,e.cX+350,e.cY+200),a.available.clubs.cubicBezierTo(e.cX+50,e.cY+250,e.cX,e.cY+50,e.cX,e.cY+150),a.available.clubs.lineTo(e.cX-50,e.cY+250),a.available.clubs.cubicBezierTo(e.cX-100,e.cY+100,e.cX,e.cY+150,e.cX,e.cY+50),a.available.spades=new Phaser.Curves.Path(e.cX-100,e.cY+100),a.available.spades.cubicBezierTo(e.cX,.1*e.height,e.cX-250,e.cY+200,e.cX-250,e.cY-100),a.available.spades.cubicBezierTo(e.cX+100,e.cY+100,e.cX+250,e.cY-100,e.cX+250,e.cY+200),a.available.spades.cubicBezierTo(e.cX+50,e.cY+250,e.cX,e.cY+50,e.cX,e.cY+150),a.available.spades.lineTo(e.cX-50,e.cY+250),a.available.spades.cubicBezierTo(e.cX-100,e.cY+100,e.cX,e.cY+150,e.cX,e.cY+50);a.available.fiveHundred=new Phaser.Curves.Path(.39*e.width+150,e.cY-100),a.available.fiveHundred.lineTo(.4*e.width-125+150,e.cY-100),a.available.fiveHundred.lineTo(.4*e.width-125+150,e.cY-20),a.available.fiveHundred.ellipseTo(70,70,-135,135,!1,0),a.available.fiveHundred.moveTo(e.cX+140,e.cY),a.available.fiveHundred.ellipseTo(70,100),a.available.fiveHundred.moveTo(.75*e.width-150,e.cY),a.available.fiveHundred.ellipseTo(70,100),vars.graphics.init()}},scrollers:{available:{},msgFixes:{uk:[["tableau","table"],["cent","penny"],["$","\xA3"]],us:[["favourite","favorite"],["MMXXII","202203"]]},init:()=>{let e=vars.scrollers,a=["Welcome to Try Peax, the Tri Peaks Solitaire game with NO micro-transactions.","Implementation by offer0 (MMXXII)","","Type of game: Patience.","","Rules:",`  The game starts with eighteen cards dealt face-down on the tableau to form three face-down "pyramids" of six cards each, and a row of ten cards beneath.`,`  The twenty-four remaining cards make up the stock. The first card from the stock is put in the waste pile (sometimes known as the foundation/discard).`,`  For a card in the tableau to be moved to the waste pile, it must be a rank higher or lower regardless of suit.`,`  This card becomes the new top card and the process is repeated several times (e.g. 9-10-J-Q-K-A-2-3-2-A-K-Q, etc.) until the sequence stops.`,`  Note the above sequence. Jacks are one rank higher than Tens, then Queens etc.`,`  If you have a King, you can roll over to an Ace, then Two etc.`,`  Same with Aces which can roll back to King, then Queen etc.`,`  Longer streaks give you more points per turned over card.`,`  Along the way, any face-down cards that are no longer overlapping are turned up.`,"",`  If the sequence is stopped, i.e. no card on the tableau can be put over the top card of the waste pile, a card is placed on the waste pile from the stock to see if it can start a new sequence.`,`  Cards are moved from the stock to the waste pile one at a time as long as it does not begin a new sequence with the cards on the tableau.`,`  The game is won if all three peaks are cleared before or after the last card from the stock is discarded to the waste pile. However, the game is lost if there are still cards that cannot be placed on the waste pile after the stock has run out.`,``,`Apart from winning, the aim is to simply enjoy the relaxing nature of the game found in most solitaire/patience type games.`,`To add to the relaxing nature, you have six music tracks to choose from. Each of which can be enabled or disabled. Or simply loop your favourite track.`,`(Those tracks can be found on the options screen)`,``,`As you play through the game you will be rewarded with "Unlock Points".`,`These can be used to unlock card sets, background tints etc.`,`(Unlockables can also be found in the options screen)`,``,`As mentioned earlier, this game has no micro transactions, so unlock points cannot be bought for real money.`,`You will accrue them as you play, whether you win or lose a hand.`,`Once you have enough Unlock Points you can either outright buy card sets (500UPs), background tints (100UPs) etc.`,`Or if you prefer, you can spin for a random unlock for 250UPs.`,`It's entirely up to you. Unlock your favourite card set for 500UPs then roll every 250UPs and get a random unlock.`,``,`This game is also available to buy on the Google/Android Marketplace`,`For $1.99 you will get the full game (as you have now), but you will be given infinite unlock points.`,`With those, you can unlock everything, unlock one thing at a time or just keep rolling for a random unlock when you're feeling lucky :)`,`With the full purchase, anytime the game is updated with new unlockables they will automatically be available to you.`,`This version does has adverts. But I will keep these to a minimum (once every 5 games). Watching an advert will automatically increase`,`the amount of unlock points you have by 100 :). Buying the game will remove all adverts.`,``,`My only request, being a solo developer, is that`,`  - if you do actually like this game`,`  - and do play it often`,`  - and you think the $1.99 is fair price`,`then please buy a copy :)`,`It's more of a thanks than a gatekeeping situation as you can unlock everything without paying a cent.`,`I would be extremely grateful knowing that my game is fun enough for you to part with your hard-earned money.`,``,`Thanks and enjoy, offer0.`],n=e.msgFixes,t=a.join("\n");n["uk"].forEach(e=>{t=t.split(e[0]),t=t.join(e[1])}),a=t.split("\n");let i=consts.htmlColours,o=[i.blueLight,i.blueDark];e.available.Rules=new Scroller(1600,consts.canvas.height,a,o,60,0,consts.depths.scroller,{textBG:!0,textBGColour:0,fullScreenBG:!0,fullScreenColour:65793})}},shaders:{available:[],fireworksRes:1/8,init:()=>{vars.DEBUG?console.log(`%cFN: shaders > init`,`${consts.console.defaults} ${consts.console.colours.functionCall}`):null;let e=vars.shaders,a=e.fireworksRes,n=consts.canvas;scene.shaders={};scene.shaders.fireworks=scene.add.shader("fireworks",n.cX,n.cY,n.width*a,n.height*a).setName("fireworks").setRenderToTexture("fireworks"),e.available.push("fireworks")},generateTextureFromFireworksShader:()=>{let e=consts.canvas,a=1/vars.shaders.fireworksRes,n=scene.add.image(e.cX,e.cY,"fireworks").setScale(a);return n}},UI:{tempUIObjects:[],init:()=>{vars.DEBUG?console.log(`%cFN: ui > init`,`${consts.console.defaults} ${consts.console.colours.functionCall}`):null;let e=consts.canvas;scene.add.text(e.width-10,e.height-10,`User ID: ${vars.localStorage.options.userID}`,{}).setColor("#300000").setDepth(666).setOrigin(1,1).setAlpha(.33).setColor("#0")},initGameScreen(){let e=consts.canvas,a=consts.fontSizes.gameScreen,n=scene.groups.gamePlayingUI,t=consts.depths.gameScreen,i=scene.add.image(e.cX,e.cY,"gameBG").setName("game_bg").setTint(vars.gameScreen.tint).setDepth(t-1),o=scene.add.image(e.cX,e.cY,"ui","tableOutline").setName("tableOutline").setDepth(t-1),s=consts.tints.orange,d=scene.add.bitmapText(e.cX,.65*e.height,"defaultFontSmall","TABLE",32,1).setName("tableText").setTint(s).setOrigin(.5).setDepth(t),l=scene.add.bitmapText(.225*e.width,.95*e.height,"defaultFontSmall","STOCK",32,1).setName("stockText").setTint(s).setOrigin(.5).setDepth(t),r=scene.add.bitmapText(e.cX,.95*e.height,"defaultFontSmall","FOUNDATION",32,1).setName("foundationText").setTint(s).setOrigin(.5).setDepth(t);n.add([i,o,d,l,r]);let c=scene.add.image(e.cX,e.cY,"whitePixel").setName("game_fg").setScale(e.width,e.height).setTint(0).setDepth(consts.depths.foreground).setInteractive(),u=scene.add.bitmapText(e.cX,.6*e.height,"defaultFont","BONUS POINTS FOR SCORE\n0",78,1).setDropShadow(8,8).setName("bonusTypeText").setTint(s).setOrigin(.5).setDepth(t+2).setAlpha(0).setVisible(!1);n.add(u);let p=scene.add.bitmapText(e.width-20,0,"defaultFont","0 - SCORE",48).setOrigin(1,0).setName("scoreText").setDepth(t),m=scene.add.bitmapText(e.width-20,60,"defaultFont","0.0s - TIME",48).setOrigin(1,0).setName("timerText").setDepth(t),h=e.cX-180,g=e.height-160,f=scene.add.image(h,g,"ui","bonusCoinBG").setName("bonusBG").setOrigin(.5,1).setDepth(1),S=scene.add.image(h,g-8,"ui","bonusCoinFG").setName("bonusFG").setOrigin(.5,1).setDepth(1),b=scene.add.bitmapText(h,g+30,"defaultFontSmall","Bonus\nMultiplier",18,1).setName("bMText").setOrigin(.5).setDepth(1);n.add([f,S,b]),vars.UI.updateMultiplier();let w=vars.game.unlockPoints,v=scene.add.bitmapText(e.width-110,150,"defaultFont",w,48).setOrigin(1,.5).setName(`playersUPCount`).setTint(16759808),D=scene.add.image(e.width-55,150,"coins","gold").setName("UIUPCoin");n.add([v,D]),h=60,g=30;let C=160,T=scene.add.image(h,g,"ui","homeIcon").setName("homeButton_ui").setOrigin(.5,0).setInteractive().setData({interactive:!0}),k=scene.add.bitmapText(h,g+90,"defaultFontSmall","HOME",a).setName("homeText").setOrigin(.5).setDepth(t);g+=C;let I=scene.add.image(h,g,"ui","optionsIcon").setName("optionsButton_ui").setOrigin(.5,0).setInteractive().setData({interactive:!0}),U=scene.add.bitmapText(h,g+90,"defaultFontSmall","OPTIONS",a).setName("optionsText").setOrigin(.5).setDepth(t);g+=C;let N=scene.add.image(h,g,"ui","newGameIcon").setName("newGameButton_ui").setOrigin(.5,0).setInteractive().setData({interactive:!0}),B=scene.add.bitmapText(h,g+90,"defaultFontSmall","NEW GAME",a).setName("newGameText").setOrigin(.5).setDepth(t),H=40,A=scene.add.image(e.width-H,e.height-H,"ui","quitIcon").setName("quitButton_ui").setOrigin(1,1).setInteractive().setData({interactive:!0}),E=scene.add.bitmapText(e.width-H-33,e.height-20,"defaultFontSmall","QUIT",a).setName("quitText").setOrigin(.5).setDepth(t),O=scene.add.image(e.width-180,e.height-H,"ui","shareIcon").setName("shareButton_ui").setOrigin(1,1).setInteractive().setData({interactive:!0}),P=scene.add.bitmapText(e.width-H-33-141,e.height-20,"defaultFontSmall","SHARE",a).setName("shareText").setOrigin(.5).setDepth(t);n.add([p,m,T,I,k,U,A,E,O,P,N,B]);let G=vars.containers.getByName("gamePlayingUIButtons");G.addMultiple([c,o,d,l,r,P,O,E,A,B,N,I,U,T,k,v,D,p,m,f,S,b])},initMainScreen:()=>{vars.particles.init();let e=consts.canvas,a=vars.particles,n=scene.containers.mainScreen,t=consts.depths.mainScreen,i=scene.add.image(e.cX,e.cY,"mainScreen","background").setAlpha(1).setDepth(t-3);n.add(i),vars.particles.suitShapeEnable(!0,0);let o=vars.particles.available.heartShape;n.add(o);let s=scene.add.image(.25*e.width,e.cY,"mainScreen","welcomeText").setTint(16763904).setName("welcomeText").setAlpha(0).setDepth(t),d=`VERSION: ${vars.version.toString()}${.8>vars.version?String.fromCharCode(945):1>vars.version?String.fromCharCode(946):""} ${vars.revision}`,l=scene.add.text(.25*e.width,.8*e.height,d,{fontSize:"24px"}).setTint(0).setOrigin(.5).setName("versionText").setAlpha(1).setDepth(t);scene.tweens.add({targets:s,alpha:1,duration:1e3,onComplete:()=>{vars.containers.ignoreLoop=!1;let e=vars.UI.tempUIObjects;vars.UI.tempUIObjects=null,scene.tweens.add({targets:e,alpha:1,duration:500})}});let r=scene.add.image(.75*e.width,e.cY,"mainScreen","rightSide").setAlpha(0).setDepth(t-2);vars.UI.tempUIObjects.push(r),n.add([s,r]);let c=e.cY-50;["newGame","hiScores","options","buy"].forEach(a=>{let i=scene.add.image(.75*e.width,c,"mainScreen","buttonBG").setName(`MS_${a}`).setAlpha(0).setDepth(t-1).setInteractive();vars.UI.tempUIObjects.push(i);let o=scene.add.image(.75*e.width,c,"mainScreen",`${a}Text`).setName(`MST_${a}Text`).setAlpha(0).setDepth(t);vars.UI.tempUIObjects.push(o),n.add([i,o]),c+=i.height+10}),a.available.letterSparkle.setDepth(t+1),n.add([l,a.available.letterSparkle]);let u=scene.add.image(.25*e.width,.9*e.height,"ui","moreInfoIcon").setName("MS_moreInfoButton").setAlpha(0).setDepth(t).setInteractive();n.add(u),vars.UI.tempUIObjects.push(u),vars.containers.current="mainScreen",vars.containers.looping=!0,a.cardSuitsEnabled=!0},initNewDealScreen:()=>{let e=consts.canvas,a=scene.containers.NGoptions,n=consts.depths.newDealScreen,t=scene.add.image(e.cX,e.cY,"whitePixel").setScale(e.width,e.height).setTint(0).setAlpha(.9).setDepth(n);a.add(t);let i=e.cX,o=250,s=e.cY-o/2,d=consts.tints.orange;["NEW DEAL","CANCEL"].forEach(e=>{let t=scene.add.image(i,s,"ui","textBoxBigBG").setName(`NG_${e.replace(/ /,"")}_Button_ui`).setDepth(n).setInteractive(),l=scene.add.bitmapText(i,s,"defaultFont",e,48).setName(`NG_${e.replace(/ /,"")}_Text`).setOrigin(.5).setDepth(n+1).setTint(d);a.add([t,l]),s+=o})},initOptionsScreen:()=>{let e=vars.localStorage.options.music,a=scene.containers.optionsScreen,n=consts.canvas,t=scene.add.image(n.cX,n.cY,"optionsBG").setName("optionsBG");a.add(t);let i=scene.add.image(330,155,"ui","optionsHeader"),o=scene.add.image(775,155,"ui","unlockablesHeader").setName("unlockablesHeader").setOrigin(0,.5).setInteractive();o.on("pointerup",vars.input.switchVisibleUnlocksContainer);let s=vars.game.unlockPoints,d=scene.add.bitmapText(n.width-245,155,"defaultFont",s,48).setOrigin(1,.5).setName(`optionsScreenUPCount`).setTint(16759808),l=scene.add.image(n.width-205,155,"coins","gold").setName("UIOUPCoin").setScale(.75),r=scene.add.image(315,400,"ui","musicHeader");a.add([i,o,r,d,l]);let c=530,u=510,p=90,m=[],h=scene.groups.musicTrackYesNos=scene.add.group().setName("musicTrackYesNos");for(let n=0;6>n;n++){let t=e[`track${n+1}`]?1:0,i=t?0:1,o=scene.add.image(c-396,u+n*p,"ui","playTrackIcon").setAlpha(1).setName(`options_track${n+1}_play`).setInteractive(),s=scene.add.image(c-205,u+n*p,"ui",`track${n+1}Header`).setName(`options_track${n+1}_header`),d=scene.add.image(c,u+n*p,"ui","noIcon").setAlpha(i).setName(`options_track${n+1}_off`).setInteractive(),l=scene.add.image(c,u+n*p,"ui","yesIcon").setAlpha(t).setName(`options_track${n+1}_on`).setInteractive();h.addMultiple([d,l]),a.add([o,d,l,s]),t?m.push(n+1):null}c=260,u=279;let g=scene.add.image(c,u,"ui","volumeBG").setOrigin(0,.5),f=scene.add.image(c+14,u,"ui","volumeFG").setName("volumeBar").setOrigin(0,.5),S=scene.add.image(c-50,u,"ui","volumeDownIcon").setName("options_volumeDown").setInteractive(),b=scene.add.image(c+270,u,"ui","volumeUpIcon").setName("options_volumeUp").setInteractive();a.add([g,f,S,b]),u=535;let w=scene.add.image(225,u,"ui","volumeFG").setOrigin(0).setName("playingTrackBar").setScale(1,.5),v=[w.width,w.height,u,p];w.setData({maxWH:v}),w.setCrop(0,0,0,v[1]),a.add(w);let D=scene.add.image(n.width-10,n.height-10,"ui","closeOptionsIcon").setOrigin(1,1).setName("options_close").setInteractive();a.add(D),vars.UI.updateVolume()},initPlayerLose:()=>{let e=consts.canvas,a=scene.containers.playerLose,n=consts.depths.playerLose,t=scene.add.image(e.cX,e.cY,"whitePixel").setScale(e.width,e.height).setTint(0).setAlpha(.9).setDepth(n);a.add(t);let i=["HOME","NEW DEAL","HIGH SCORES","EXIT"],o=e.cX,s=1/i.length*e.height,d=s-140,l=consts.tints.orange;i.forEach(e=>{let t=scene.add.image(o,d,"ui","textBoxBigBG").setName(`NG_${e.replace(/ /,"")}_Button_ui`).setDepth(n).setInteractive(),i=scene.add.bitmapText(o,d,"defaultFont",e,48).setName(`NG_${e.replace(/ /,"")}_Text`).setOrigin(.5).setDepth(n+1).setTint(l);a.add([t,i]),d+=s})},initWellDone:null,buildSplashScreen:()=>{let e=scene.containers.splashScreen;vars.audio.playSound("logoSound");let a=consts.depths.slashScreen,n=consts.canvas,t=scene.add.image(n.cX,n.cY,"logoScreen","background").setDepth(a-1);e.add(t);let i=[];[100,90,80].forEach(t=>{let o=scene.add.image(n.cX,n.cY,"logoScreen","outerCircle").setDepth(a).setScale(t/100);e.add(o),i.push(o)});let o=10*getRandom(0,35),s=scene.add.image(n.cX,n.cY,"logoScreen","rotatorCentre").setDepth(a).setAngle(o),d=scene.add.image(n.cX,n.cY,"logoScreen","ogsInner").setDepth(a+2),l=scene.add.image(n.cX,n.cY-66,"logoScreen","ogsOuter").setDepth(a+1).setAngle(o);e.add([s,d,l]),scene.tweens.add({targets:[i[0],i[2]],angle:"+=20",duration:4900}),scene.tweens.add({targets:[i[1],s,l],angle:"-=20",duration:4900}),scene.tweens.add({targets:e,alpha:1,duration:1500,hold:2e3,yoyo:!0,onComplete:(e,a)=>{a[0].destroy(),vars.init("GAMESCREENS")}})},buildWellDone:()=>{let e=consts.canvas,a=scene.containers.wellDone,n=consts.depths.wellDone,t=scene.add.image(e.cX,e.cY,"whitePixel").setScale(e.width,e.height).setTint(0).setAlpha(.95).setDepth(n-2);a.add(t);let i=scene.add.image(e.cX,.1*e.height,"ui","winStars").setName("stars").setDepth(n);scene.tweens.add({targets:i,y:.25*e.height,scale:2,duration:1e3,repeat:-1,yoyo:!0,ease:"Bounce.easeOut"});let o=scene.add.bitmapText(e.cX,e.cY,"defaultFont","Well Done!",64).setOrigin(.5).setName("wellDoneText").setDropShadow(6,6).setDepth(n).setAlpha(0).setLetterSpacing(20);scene.tweens.add({targets:o,y:.4*e.height,scale:1.5,duration:2e3,ease:"Quad.easeInOut",onComplete:()=>{vars.UI.wellDoneShowScore()}}),scene.tweens.add({targets:o,alpha:1,duration:500,ease:"Quad.easeInOut"});let s=1/vars.shaders.fireworksRes,d=scene.add.image(e.cX,e.cY,"fireworks").setScale(s).setDepth(n-1);a.add([d,i,o]),vars.containers.show("wellDone",!0)},destroyAllCards(){["cardCurrent","cardsDealt","cardsLeft"].forEach(e=>{vars.containers.empty(e)}),vars.game.deal=null,vars.game.deck=null},displayUnlock(e,a,n){console.log(`Displaying unlock ${n.name}`),vars.game.unlockables.displayUnlock(n)},hideGamePlayingUI:()=>{scene.groups.gamePlayingUIButtons},increaseUPCount:()=>{let e,a=vars.game,n=a.unlockPointData;if("[0,0]"!==JSON.stringify(n.scoreCoins))e="score";else if("[0,0]"!=JSON.stringify(n.timeCoins))e="time";else return a.resetUPData(),vars.containers.getByName("gamePlayingUI").getByName("bonusTypeText").setAlpha(0).setVisible(!1),vars.game.unlockables.updateUIUnlockPoints(),a.deal.win?new winDance:vars.containers.showNGOnFail(!0),!0;let t=`${e}Coins`,i=n[t];vars.DEBUG?console.log({type:e,coins:i}):null;let o=vars.containers.getByName("gamePlayingUI"),s=o.getByName("playersUPCount"),d=o.getByName("UIUPCoin");if("score"!==e)o.getByName("bonusTypeText").setText(`BONUS POINTS FOR TIME\n${n.timePoints}`);else{let e=o.getByName("bonusTypeText");e.setAlpha(1).setVisible(!0),o.bringToTop(e)}let l=0,r=750,u=[10,1],p=[consts.canvas.cX,consts.canvas.cY],m=[d.x,d.y];i.forEach((a,i)=>{for(let o=0;o<a;o++){let d=i?"bronze":"silver",c=consts.depths[`coins_${d}`],h=scene.add.image(p[0],p[1],"coins",d).setAlpha(0).setDepth(c),g=u[i],f=o*250;vars.DEBUG?console.log(`${d} coin ${o+1} for ${e} created. Delay: ${f}`):null,scene.tweens.add({targets:h,alpha:1,delay:f+l,duration:r/3,onStart:()=>{let e=vars.containers.getByName("gamePlayingUI").getByName("bonusTypeText"),a=e.text.split("\n"),n=~~a[1];a[1]=n-g,e.setText(a.join("\n"))}}),scene.tweens.add({targets:h,x:m[0],y:m[1],duration:r,delay:f+250+l,onComplete:(d,l)=>{l[0].destroy(),vars.audio.playSound("coin"),s.setText(~~s.text+g);o+1!==a||i||n[t][1]||("time"===e?(n[t]=[0,0],vars.UI.increaseUPCount()):(n[t]=[0,0],vars.UI.increaseUPCount()));o+1===a&&i&&(n[t]=[0,0],vars.UI.increaseUPCount())}}),o+1!==a||i||(l=f+r)}})},mainScreenFadeIn:()=>{},newMessage:(e=null,a=-1,n=-1,t=0,i=1e3,o=64,s=16777215)=>{if(!e)return!1;-1!==a&&a||(a=consts.canvas.cX),-1!==n&&n||(n=consts.canvas.cY),i||(i=1e3);let d=!o||32>=o?"defaultFontSmall":"defaultFont",l=scene.add.bitmapText(a,n,d,e,o).setOrigin(.5).setLetterSpacing(10).setDropShadow(8,8).setTint(s).setDepth(255);scene.tweens.add({targets:l,y:0,alpha:0,duration:i,delay:t,onComplete:(e,a)=>{a[0].destroy()}})},showCardSpread:()=>{let e=[],a=[];for(let n=-Math.PI/4;n<=Math.PI/4;n+=Math.PI/2/52)e.push(n),a.push(Math.cos(n));let n=[];["H","C","D","S"].forEach(e=>{for(let a,t=1;14>t;t++)a=1==t?"A":11===t?"J":12===t?"Q":13===t?"K":t,n.push(`${a}${e}`)}),n.push("00");let t=consts.canvas,i=vars.containers.getByName("unlockedCardSpread");i.setAlpha(1).setVisible(!0);let o=scene.add.image(t.cX,t.cY,"whitePixel").setTint(0).setAlpha(.8).setScale(t.width,t.height);i.add(o);let s=450,d=0,l=50;n.forEach((n,t)=>{let o=scene.add.image(s,1040-a[t]*640,"cards",n).setName(`spread_${n}`).setRotation(e[t]).setDepth(t).setAlpha(0);scene.tweens.add({targets:o,alpha:1,delay:d,duration:l,hold:(52-t)*l,onComplete:(e,a)=>{scene.tweens.add({targets:a[0],alpha:0,delay:50*(72-a[0].depth),duration:50,onComplete:(e,a)=>{a[0].destroy(),"spread_AH"===a[0].name&&(vars.containers.getByName("unlockedCardSpread").setAlpha(0).setVisible(!1),vars.game.unlockables.showContainer("unlocked"))}})}}),i.add(o),s+=20,d+=l})},showForegroundBarrier:(e=!0)=>{let a=e?1:0,n=scene.children.getByName("game_fg");scene.tweens.add({targets:n,alpha:a,duration:500})},showGameplayUI(e=!0,a=.1,n=!1){if(!1===e&&.5<=a)return console.log(`Invalid minAlpha (${a}) for fade out`),!1;let t=[];e||"ai"!==n?!e&&n&&("winLose"===n?t.push("scoreText","timerText","playersUPCount","UIUPCoin"):"initGame"===n?t.push("scoreText","timerText","playersUPCount","UIUPCoin","bonusBG","bonusFG","bMText","tableOutline","tableText","stockText","foundationText"):"tintView"===n&&t.push("scoreText","timerText","playersUPCount","UIUPCoin","tableOutline","tableText","stockText","foundationText")):(vars.DEBUG?console.log(`AI requested fades`):null,t.push("scoreText","timerText","bonusBG","bonusFG","bMText","tableOutline","tableText","stockText","foundationText"));let i=e?1:a;e&&vars.game.deal&&(t.push("game_fg"),scene.children.getByName("game_fg").alpha=0);scene.groups.gamePlayingUIButtons.getChildren().forEach(e=>{t.includes(e.name)||scene.tweens.add({targets:e,alpha:i,duration:333,onComplete:(a,n)=>{.5>n[0].alpha?n[0].getData("interactive")&&(vars.DEBUG?console.log(`%cDisabling ${e.name} (interactivity)`,"color: red"):null,n[0].disableInteractive()):n[0].getData("interactive")&&(vars.DEBUG?console.log(`%cEnabling ${e.name} (interactivity)`,"color: green"):null,n[0].setInteractive())}})})},showMainScreen:()=>{vars.game.deck.resetStreak(),vars.UI.destroyAllCards(),vars.containers.startIntroLoop(!0),vars.UI.showForegroundBarrier(!0),vars.containers.show("mainScreen",!0)},showWellDone:()=>{if(scene.containers.wellDone.visible)return!1;let e=scene.containers.wellDone;e.setVisible(!0),scene.tweens.add({targets:e,alpha:1,duration:500,onComplete:()=>{}})},swapMusicEnableButton:(e,a=!1)=>{let n=vars.containers.getByName("optionsScreen"),t=n.getByName(`options_track${e}_off`),i=n.getByName(`options_track${e}_on`),o=!0;i.alpha?(t.setAlpha(1),i.setAlpha(0),o=!1):(t.setAlpha(0),i.setAlpha(1),o=!0);vars.music.updateAvailableTracks(`track${e}`,o),vars.localStorage.updateTrackList(`track${e}`,o)},swapMusicPlayButton:e=>{let a=e;"playTrackIcon"===a.frame.name?a.setFrame("stopTrackIcon"):a.setFrame("playTrackIcon")},updateMultiplier:e=>{let a=scene.groups.gamePlayingUI,n=a.getByName("bonusFG"),t=n.width,i=n.height;n.setCrop(0,(10-e)/10*i,t,i)},updateScore:e=>{let a=scene.groups.gamePlayingUI.getByName("scoreText");a.text=`${e} - SCORE`},updateTimer:e=>{let a=vars.containers.getByName("gamePlayingUI").getByName("timerText");a.setText(`${e}s - TIME`)},updateVolume:()=>{let e=vars.audio.volume/10,a=vars.containers.getByName("optionsScreen"),n=a.getByName("volumeBar");n.setCrop(0,0,192*e,n.height)},wellDoneDestroy:()=>{vars.containers.empty("wellDone")},wellDoneShowContinueButton:()=>{let e=consts.canvas,a=scene.containers.wellDone,n=scene.add.image(e.cX,.75*e.height,"ui","textBoxBigBG").setName("WD_enterName").setScale(1.4,1).setAlpha(0).setDepth(18).setInteractive(),t=scene.add.bitmapText(e.cX,.75*e.height,"defaultFont",`ENTER NAME`,64).setOrigin(.5).setName("enterNameText").setDepth(19).setAlpha(0).setLetterSpacing(10).setTint(consts.tints.orange);a.add([n,t]),scene.tweens.add({targets:[n,t],alpha:1,duration:1e3})},wellDoneShowScore:()=>{let e=consts.canvas,a=scene.containers.wellDone,n=vars.game.deck.playerScore;vars.game.scoreCard.score=n;let t=scene.add.bitmapText(e.cX,e.cY,"defaultFont",`Your score is ${n}`,64).setOrigin(.5).setName("wellDoneText").setDepth(15).setAlpha(0).setLetterSpacing(20).setDropShadow(6,6);a.add(t),scene.tweens.add({targets:t,alpha:1,duration:1e3}),scene.tweens.add({targets:t,scale:1.5,duration:2e3,onComplete:()=>{vars.UI.wellDoneShowContinueButton()}})}}};